# README.md
# India RAG System

A Retrieval-Augmented Generation (RAG) system for information about India, built with FastAPI, Supabase, Groq, and Gemini.

## Features

- Document processing and chunking
- Embedding generation using Gemini
- Vector storage and search using Supabase
- Response generation using Groq's Llama 3 70B model
- RESTful API for querying and document management

## Setup

1. Clone the repository
2. Install dependencies: `pip install -r requirements.txt`
3. Set up environment variables in `.env`
4. Set up the database in Supabase (see Database Setup below)
5. Run the application: `python src/main.py`

## Database Setup

Run the following SQL in your Supabase SQL editor:

```sql
-- Create a table for documents
CREATE TABLE IF NOT EXISTS documents (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title TEXT NOT NULL,
    content TEXT NOT NULL,
    chunk_id TEXT NOT NULL,
    embedding VECTOR(768),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Create a function for vector search
CREATE OR REPLACE FUNCTION match_documents(
    query_embedding VECTOR(768),
    match_count INT DEFAULT 5
)
RETURNS TABLE(
    id BIGINT,
    title TEXT,
    content TEXT,
    chunk_id TEXT,
    embedding VECTOR(768),
    created_at TIMESTAMP WITH TIME ZONE,
    similarity FLOAT
)
LANGUAGE plpgsql
AS $$
BEGIN
    RETURN QUERY
    SELECT
        d.id,
        d.title,
        d.content,
        d.chunk_id,
        d.embedding,
        d.created_at,
        1 - (d.embedding <=> query_embedding) AS similarity
    FROM
        documents d
    ORDER BY
        d.embedding <=> query_embedding
    LIMIT match_count;
END;
$$;

-- Create an index for faster vector search
CREATE INDEX IF NOT EXISTS documents_embedding_idx ON documents USING hnsw (embedding vector_cosine_ops);

-- Create policies to allow access
CREATE POLICY "Enable read access for all users" ON documents FOR SELECT USING (true);
CREATE POLICY "Enable insert access for all users" ON documents FOR INSERT WITH CHECK (true);
CREATE POLICY "Enable delete access for all users" ON documents FOR DELETE USING (true);